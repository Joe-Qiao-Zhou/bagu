# 基础概念

- URI：统一资源标识符，URL是具体的URI，通过**定位**的方式唯一确定资源；URI可以是相对的，但URL是绝对的

- 请求报文：`请求行+请求头+请求空行+请求体`
  - GET方法用于获取资源，POST方法用于传输数据
  - GET安全，因此不会改变服务器状态，而POST会将数据存在数据库中，状态改变导致不安全
- 响应报文：`状态行+响应头+响应空行+响应体`
- 状态码
  - 1xx 信息性
  - 2xx 成功
  - 3xx 重定向
  - 4xx 客户端错误
    - 400 Bad Request：请求中存在语法错误
    - 401 Unauthorized：需要认证信息
    - 403 Forbidden：请求被拒绝
    - 404 Not Found
  - 5xx 服务器错误
    - 500 Internal Server Error
    - 503 Service Unavailable

- 连接管理
  - 长连接：建立一次TCP连接，进行多次HTTP通信，HTTP1.1后默认长连接
  - 流水线：HTTP请求默认按顺序发送，收到响应后再发下一个请求；可连续发出请求不需要等待响应
- 虚拟主机：1.1后可以是一台服务器拥有多个域名，逻辑上视为多个服务器

## 通信数据转发

1. 代理：代理服务器接受客户端请求，转发给其他服务器
   1. 使用目的：缓存、负载均衡、网络访问控制、访问日志记录
   2. 正向代理：客户端和其他所有服务器的代理者，对客户端负责
   3. 反向代理：所代理的服务器与客户端之间的代理者，对服务器负责，一般位于内网中，用户无法察觉
2. 网关：将HTTP转为其他协议进行通信，请求其他非HTTP服务
3. 隧道：SSL等加密手段，在CS之间建立安全通信线路

# Cookie、Session与缓存

- Cookie：HTTP默认无状态，1.1后引入Cookie，由服务器发送到浏览器并保存在本地，会在浏览器再次发请求时携带
  - 用途：会话状态管理，如购物车；个性化设置；浏览器行为跟踪
  - 分为会话期Cookie（浏览器关闭后删除）和持久性Cookie
- Session：存储在服务器，可以用于维护用户登录状态
  - 用户提交用户名和密码的表单，放入HTTP请求报文中
  - 服务器验证，若正确则将用户信息存储到Redis，key为Session ID
  - 响应报文中包含该Session ID，客户端收到后将该Cookie值存入浏览器
  - 客户端对同一个服务器请求时会包含该Cookie，服务器收到后提取出Seesion ID，从Redis中取出用户信息继续业务操作
  - 若浏览器禁用Coookie，则必须使用URL重写技术将ID作为URL参数传递
- 两者差别
  - C只能存ASCII码，S可存任意类型数据
  - C存在客户端，不够安全；而如果所有信息都存在S中开销太大
- 缓存：可以缓解服务器压力，降低客户端获取资源的延迟；可以让代理服务器或者客户端进行缓存
  - 在无缓存数据时，服务器会将数据与缓存规则一并返回
  - HTTP1.1通过`Cache-Control`首部字段控制缓存
    - `no-store`禁止缓存；`no-cache`强制确认缓存，确认有效后才能响应请求；`private	`单独用户使用，一般存在浏览器中；`public`可被多个用户使用，一般存在代理服务器中

# HTTPS

- HTTP的安全问题：明文通信，内容可能被窃听；不验证通信方身份，可能伪装；无法证明报文完整性，可能遭篡改
- HTTPS让HTTP先和SSL通信，再由SSL和TCP通信，使用隧道技术，实现加密防窃听、认证防伪装和完整性保护防篡改的特性
  - 加密：HTTPS使用非对称密钥加密对称密钥，使用对称密钥加密通信
  - 认证：通过CA颁发的证书认证，里面包括已签名的公钥，服务器将证书发给客户端，客户端使用签名验证公钥，通过则可通信
  - 完整性保护：SSL的报文摘要功能，HHTP提供了MD5报文摘要，但不安全，HHTPS的报文摘要结合了加密和验证两项操作

- HTTP1.1新特性：默认长连接，支持流水线，支持同时打开多个TCP，支持虚拟主机，新增100状态码，支持分块传输编码，新增缓存处理指令max-age